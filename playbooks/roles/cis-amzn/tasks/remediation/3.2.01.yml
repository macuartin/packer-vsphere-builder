---

- name: Set check facts
  set_fact:
    cis_code: &cis_code '3.2.1'
    cis_name: &cis_name Ensure source routed packets are not accepted
    cis_profile: &cis_profile level-1
    cis_scored: &cis_scored scored
    cis_section: &cis_section section-3
  tags:
    - always

- name: CIS {{ cis_code }} - {{ cis_name }}
  block:

  - import_tasks: ../commons/set-sysctl.yml
    vars:
      param: net.ipv4.conf.all.accept_source_route
      value: 0
      cis_code: *cis_code

  - import_tasks: ../commons/set-sysctl.yml
    vars:
      param: net.ipv4.conf.default.accept_source_route
      value: 0
      cis_code: *cis_code

  - name: "APPLY | {{ cis_code }} - flash routes notified ..."
    debug:
      msg: "Notify flash routes ..."
    notify: Flush ipv4 route
    tags:
      - apply

  tags:
    - *cis_profile
    - *cis_section
    - *cis_code
    - *cis_scored

...
